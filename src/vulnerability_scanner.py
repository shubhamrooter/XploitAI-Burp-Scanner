import re

class VulnerabilityScanner:
    def __init__(self, rules_loader, threat_intel, ai_model):
        self.rules_loader = rules_loader
        self.threat_intel = threat_intel
        self.ai_model = ai_model

    def scan(self, request, response):
        findings = []
        rules = self.rules_loader.get_rules()
        for rule in rules:
            if re.search(rule["pattern"], response, re.IGNORECASE):
                findings.append(rule["name"])
        for domain in self.threat_intel.get_intel()["malicious_domains"]:
            if domain in request:
                findings.append("Malicious Domain: {}".format(domain))
        if self.ai_model:
            predictions = self.ai_model.predict(response)
            findings.extend(predictions)
        return findings